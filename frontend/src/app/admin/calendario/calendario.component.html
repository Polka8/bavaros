<div class="calendar-container">
  <div class="header">
    <div class="left-section">
      <h2>BENVENUTO CUTER GABRIEL</h2>
      <div class="date-navigation">
        <button mat-icon-button (click)="navigatePeriod(-1)">
          <mat-icon>chevron_left</mat-icon>
        </button>
        
        <div class="current-date" (click)="showDatePicker = true">
          {{ viewDate | date:'EEEE d MMMM y' | uppercase }}
        </div>

        <button mat-icon-button (click)="navigatePeriod(1)">
          <mat-icon>chevron_right</mat-icon>
        </button>

        <mat-form-field *ngIf="showDatePicker">
          <input matInput 
                [matDatepicker]="datePicker" 
                [(ngModel)]="viewDate"
                (dateChange)="onDateSelected($event.value)"
                placeholder="GG/MM/AAAA">
          <mat-datepicker-toggle matSuffix [for]="datePicker"></mat-datepicker-toggle>
          <mat-datepicker #datePicker></mat-datepicker>
        </mat-form-field>
      </div>
    </div>

    <div class="right-section">
      <button mat-raised-button 
              color="primary" 
              (click)="goToToday()"
              class="today-button">
        OGGI
      </button>
      
      <div class="view-selector">
        <button mat-button 
                *ngFor="let view of [CalendarView.Month, CalendarView.Week, CalendarView.Day]"
                [class.active]="view === view"
                (click)="setView(view)">
          {{ view | uppercase }}
        </button>
      </div>
    </div>
  </div>

  <div class="calendar-body">
    <div [ngSwitch]="view">
      <!-- Vista Mese -->
      <div *ngSwitchCase="CalendarView.Month" class="month-view">
        <div class="days-header">
          <div *ngFor="let day of ['Lun', 'Mar', 'Mer', 'Gio', 'Ven', 'Sab', 'Dom']" 
               class="day-header">
            {{ day }}
          </div>
        </div>
        <div class="weeks-container">
          <div *ngFor="let week of daysInMonth" class="week-row">
            <div *ngFor="let day of week" 
                 class="day-cell"
                 [class.current-month]="isSameMonth(day, viewDate)"
                 [class.today]="isToday(day)">
              <div class="day-number">{{ day | date:'d' }}</div>
              <div class="events">
                <div *ngFor="let event of getEventsForDay(day)" 
                     class="event-preview">
                  {{ event.title }}
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Vista Settimana -->
      <div *ngSwitchCase="CalendarView.Week" class="week-view">
        <div class="week-range-header">
          {{ weekRange }}
        </div>
        <div class="days-grid">
          <div *ngFor="let day of daysInWeek" 
               class="day-cell"
               [class.current-week]="isSameWeek(day, viewDate, { weekStartsOn: 1 })"
               [class.today]="isToday(day)">
            <div class="day-number">{{ day | date:'d' }}</div>
            <div class="events">
              <div *ngFor="let event of getEventsForDay(day)" 
                   class="event-preview">
                {{ event.title }}
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Vista Giorno -->
      <div *ngSwitchCase="CalendarView.Day" class="timeline-view">
        <div class="time-column">
          <div *ngFor="let slot of timeSlots" class="time-slot">
            {{ slot.label }}
          </div>
        </div>
        <div class="events-column">
          <div *ngFor="let slot of timeSlots" class="time-slot">
            <div class="hour-line"></div>
            <div *ngFor="let event of getEventsForHour(slot.hour)"
                 class="event"
                 [style.top.px]="calculateEventTop(event)"
                 [style.height.px]="calculateEventHeight(event)">
              <div class="event-content">
                <div class="event-time">
                  {{ event.start | date:'HH:mm' }} - {{ event.end | date:'HH:mm' }}
                </div>
                <div class="event-title">{{ event.title }}</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>